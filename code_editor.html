<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Editor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .editor-container, .output-container {
            display: grid;
            grid-template-columns: 50px 1fr;
            width: 80%;
            height: 35vh;
            border: 1px solid #ccc;
            background-color: white;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }
        .line-numbers, .output-line-numbers {
            background-color: #eee;
            color: #888;
            text-align: right;
            user-select: none;
            padding: 10px 0;
            box-sizing: border-box;
            overflow: hidden;
            line-height: 1.5;
        }
        .code-area, .output-area {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            padding: 10px;
            font-size: 14pt;
            overflow: auto;
            white-space: pre;
            box-sizing: border-box;
            line-height: 1.5;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="editor-container">
        <div id="line-numbers" class="line-numbers"></div>
        <textarea id="editor" class="code-area" oninput="updateEditor()"></textarea>
    </div>
    <div class="output-container">
        <div id="line-numbers-output" class="output-line-numbers"></div>
        <pre id="output" class="output-area"></pre>
    </div>
    <div class="controls">
        <button onclick="formatCode()">Format Code</button>
        <button onclick="copyToClipboard()">Copy raw</button>
    </div>

    <script src="https://cdn.rawgit.com/beautify-web/js-beautify/v1.14.0/js/lib/beautify.js"></script>
    <script>
        const editor = document.getElementById('editor');
        const lineNumbers = document.getElementById('line-numbers');
        const output = document.getElementById('output');
        const lineNumbersOutput = document.getElementById('line-numbers-output');

        function updateLineNumbers() {
            const lines = editor.value.split('\n').length;
            const lineNumHtml = Array.from({ length: lines }, (_, i) => i + 1).join('<br>');
            lineNumbers.innerHTML = lineNumHtml;
            lineNumbersOutput.innerHTML = lineNumHtml;
        }

        function updateEditor() {
            updateLineNumbers();
            updateOutput();
        }

        function updateOutput() {
            output.textContent = editor.value;
        }

        function formatCode() {
            const code = editor.value;
            const formattedCode = js_beautify(code, { indent_size: 2, space_in_empty_paren: true });
            editor.value = formattedCode;
            updateEditor();
        }

        function copyToClipboard() {
            const code = editor.value;
            const tempInput = document.createElement('textarea');
            tempInput.style.position = 'absolute';
            tempInput.style.left = '-99999px';
            tempInput.value = code;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            alert('Code copied to clipboard!');
        }

        // Initial setup
        updateLineNumbers();
        updateOutput();

        // Synchronize scrolling between the editor and line numbers
        editor.addEventListener('scroll', () => {
            lineNumbers.scrollTop = editor.scrollTop;
        });

        output.addEventListener('scroll', () => {
            lineNumbersOutput.scrollTop = output.scrollTop;
        });
    </script>
</body>
</html>
